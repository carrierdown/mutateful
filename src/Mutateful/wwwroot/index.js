var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function s(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function a(t){return document.createTextNode(t)}function $(){return a(" ")}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let m;function d(t){m=t}function h(t){(function(){if(!m)throw new Error("Function called outside component initialization");return m})().$$.on_mount.push(t)}const b=[],w=[],y=[],A=[],v=Promise.resolve();let R=!1;function _(t){y.push(t)}let x=!1;const C=new Set;function k(){if(!x){x=!0;do{for(let t=0;t<b.length;t+=1){const e=b[t];d(e),M(e.$$)}for(d(null),b.length=0;w.length;)w.pop()();for(let t=0;t<y.length;t+=1){const e=y[t];C.has(e)||(C.add(e),e())}y.length=0}while(b.length);for(;A.length;)A.pop()();R=!1,x=!1,C.clear()}}function M(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const E=new Set;function S(t,e){t&&t.i&&(E.delete(t),t.i(e))}function U(t,e,n,r){if(t&&t.o){if(E.has(t))return;E.add(t),undefined.c.push((()=>{E.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function P(t){t&&t.c()}function j(t,n,l,c){const{fragment:s,on_mount:i,on_destroy:f,after_update:u}=t.$$;s&&s.m(n,l),c||_((()=>{const n=i.map(e).filter(o);f?f.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(_)}function H(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function O(t,e){-1===t.$$.dirty[0]&&(b.push(t),R||(R=!0,v.then(k)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function z(e,o,l,c,s,i,u,a=[-1]){const $=m;d(e);const p=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map($?$.$$.context:o.context||[]),callbacks:n(),dirty:a,skip_bound:!1,root:o.target||$.$$.root};u&&u(p.root);let g=!1;if(p.ctx=l?l(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&s(p.ctx[t],p.ctx[t]=o)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](o),g&&O(e,t)),n})):[],p.update(),g=!0,r(p.before_update),p.fragment=!!c&&c(p.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);p.fragment&&p.fragment.l(t),t.forEach(f)}else p.fragment&&p.fragment.c();o.intro&&S(e.$$.fragment),j(e,o.target,o.anchor,o.customElement),k()}d($)}class F{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const N=[];function q(e,n=t){let r;const o=new Set;function c(t){if(l(e,t)&&(e=t,r)){const t=!N.length;for(const t of o)t[1](),N.push(t,e);if(t){for(let t=0;t<N.length;t+=2)N[t][0](N[t+1]);N.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(l,s=t){const i=[l,s];return o.add(i),1===o.size&&(r=n(c)||t),l(e),()=>{o.delete(i),0===o.size&&(r(),r=null)}}}}const B=(new signalR.HubConnectionBuilder).withUrl("http://localhost:5000/mutatefulHub").withHubProtocol(new signalR.protocols.msgpack.MessagePackHubProtocol).build();B.start().then((()=>{console.log("Connection established")}),(()=>{console.log("Failed to connect :(")}));const D=t=>({subscribe:q(new Uint8Array,(e=>(B.on("SetClipDataOnClient",((n,r)=>{n===t&&(console.log("DebugMessage - received data: ",r),e(r))})),()=>{console.log("readableClip end called")}))).subscribe});class I{constructor(t){this.notes=[],this.length=t}}class T{constructor(t,e,n,r){this.pitch=t,this.start=e,this.duration=n,this.velocity=r}}function V(t){let e=G(t,2),n=new I(e),r=function(t,e=0){let n=new Uint8Array(2);return n[0]=t[e],n[1]=t[e+1],new Uint16Array(n.buffer)[0]}(t,7),o=9;for(let e=0;e<r;e++)n.notes.push(new T(t[o],G(t,o+1),G(t,o+5),G(t,o+9))),o+=25;return n}function G(t,e=0){let n=new Uint8Array(4);for(let r=0;r<4;r++)n[r]=t[r+e];return new Float32Array(n.buffer)[0]}function J(e){let n,r,o,l,c,m,d,h,b,w=e[0].toUpperCase()+"",y=e[6](e[4])+"";return{c(){n=$(),r=u("div"),o=u("div"),l=u("span"),c=a(w),m=u("span"),m.textContent="Clip title goes here",d=$(),h=u("canvas"),b=a(y),p(l,"class","clip-slot--ref svelte-u8c4fv"),p(m,"class","clip-slot--title svelte-u8c4fv"),p(o,"class","clip-slot--header svelte-u8c4fv"),p(h,"class","clip-slot--preview svelte-u8c4fv"),p(h,"width",e[2]),p(h,"height",e[3]),p(r,"class","clip-slot svelte-u8c4fv")},m(t,f){i(t,n,f),i(t,r,f),s(r,o),s(o,l),s(l,c),s(o,m),s(r,d),s(r,h),s(h,b),e[7](h)},p(t,[e]){1&e&&w!==(w=t[0].toUpperCase()+"")&&g(c,w),16&e&&y!==(y=t[6](t[4])+"")&&g(b,y),4&e&&p(h,"width",t[2]),8&e&&p(h,"height",t[3])},i:t,o:t,d(t){t&&f(n),t&&f(r),e[7](null)}}}function K(t,e,n){let r,{clipRef:o}=e;const l=D(o||"A1");let s;c(t,l,(t=>n(4,r=t)));let i=!1,f=300,u=150;h((()=>{i=!0;let t=getComputedStyle(s);n(2,f=parseInt(t.getPropertyValue("width"),10)),n(3,u=parseInt(t.getPropertyValue("height"),10))}));return t.$$set=t=>{"clipRef"in t&&n(0,o=t.clipRef)},[o,s,f,u,r,l,t=>(i&&(t=>{const e=s.getContext("2d");console.log(f,u),e.clearRect(0,0,f,u),e.fillStyle="white",e.fillRect(0,0,f,u),e.fillStyle="red";let n=Math.min(t.length,16),r=t.notes.map((t=>t.pitch)),o=Math.max(...r),l=Math.min(...r),c=f/n,i=u/(o+1-l);for(let r of t.notes){if(r.start>=n)return;e.fillRect(Math.floor(c*r.start),Math.floor(i*(r.pitch-l)),Math.floor(c),Math.floor(i))}})(V(t)),""),function(t){w[t?"unshift":"push"]((()=>{s=t,n(1,s)}))}]}class L extends F{constructor(t){super(),z(this,t,K,J,l,{clipRef:0})}}function Q(e){let n,r,o,l,c,a,g,m,d,h,b,w,y,A,v,R,_,x,C,k,M,E,O,z,F,N,q,B,D,I;return o=new L({props:{clipRef:"A1"}}),c=new L({props:{clipRef:"A2"}}),g=new L({props:{clipRef:"A3"}}),d=new L({props:{clipRef:"A4"}}),b=new L({props:{clipRef:"A5"}}),y=new L({props:{clipRef:"A6"}}),v=new L({props:{clipRef:"A7"}}),_=new L({props:{clipRef:"A8"}}),C=new L({props:{clipRef:"A9"}}),M=new L({props:{clipRef:"A10"}}),O=new L({props:{clipRef:"A11"}}),F=new L({props:{clipRef:"A12"}}),q=new L({props:{clipRef:"A13"}}),D=new L({props:{clipRef:"A14"}}),{c(){n=$(),r=u("div"),P(o.$$.fragment),l=$(),P(c.$$.fragment),a=$(),P(g.$$.fragment),m=$(),P(d.$$.fragment),h=$(),P(b.$$.fragment),w=$(),P(y.$$.fragment),A=$(),P(v.$$.fragment),R=$(),P(_.$$.fragment),x=$(),P(C.$$.fragment),k=$(),P(M.$$.fragment),E=$(),P(O.$$.fragment),z=$(),P(F.$$.fragment),N=$(),P(q.$$.fragment),B=$(),P(D.$$.fragment),p(r,"class","cells svelte-1jmqogg")},m(t,e){i(t,n,e),i(t,r,e),j(o,r,null),s(r,l),j(c,r,null),s(r,a),j(g,r,null),s(r,m),j(d,r,null),s(r,h),j(b,r,null),s(r,w),j(y,r,null),s(r,A),j(v,r,null),s(r,R),j(_,r,null),s(r,x),j(C,r,null),s(r,k),j(M,r,null),s(r,E),j(O,r,null),s(r,z),j(F,r,null),s(r,N),j(q,r,null),s(r,B),j(D,r,null),I=!0},p:t,i(t){I||(S(o.$$.fragment,t),S(c.$$.fragment,t),S(g.$$.fragment,t),S(d.$$.fragment,t),S(b.$$.fragment,t),S(y.$$.fragment,t),S(v.$$.fragment,t),S(_.$$.fragment,t),S(C.$$.fragment,t),S(M.$$.fragment,t),S(O.$$.fragment,t),S(F.$$.fragment,t),S(q.$$.fragment,t),S(D.$$.fragment,t),I=!0)},o(t){U(o.$$.fragment,t),U(c.$$.fragment,t),U(g.$$.fragment,t),U(d.$$.fragment,t),U(b.$$.fragment,t),U(y.$$.fragment,t),U(v.$$.fragment,t),U(_.$$.fragment,t),U(C.$$.fragment,t),U(M.$$.fragment,t),U(O.$$.fragment,t),U(F.$$.fragment,t),U(q.$$.fragment,t),U(D.$$.fragment,t),I=!1},d(t){t&&f(n),t&&f(r),H(o),H(c),H(g),H(d),H(b),H(y),H(v),H(_),H(C),H(M),H(O),H(F),H(q),H(D)}}}class W extends F{constructor(t){super(),z(this,t,null,Q,l,{})}}function X(e){let n,r;return n=new W({}),{c(){P(n.$$.fragment)},m(t,e){j(n,t,e),r=!0},p:t,i(t){r||(S(n.$$.fragment,t),r=!0)},o(t){U(n.$$.fragment,t),r=!1},d(t){H(n,t)}}}return new class extends F{constructor(t){super(),z(this,t,null,X,l,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=index.js.map
